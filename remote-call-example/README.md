#### Contents

* [`ex.c`](ex.c), [`ex.h`](ex.h)
  A simple foreign library (`libex`) for testing.

* [`ex_bindings.ml`](ex_bindings.ml)
  Bindings to `libex`.

* [`ex_generator.ml`](ex_generator.ml)
  Generator for the various source and header files.

* [`ex_main.ml`](ex_main.ml)
  The main module of the example:  Instantiate the bindings (`Ex_bindings`) with the generated code (`Ex_generated`) and call the functions.

* [`ex_remote_helpers.h`](ex_remote_helpers.h)
  Define the various macros used by the code generated by `cstubs` (see [`cstubs_remote_internals.h`](../src/ctypes/ctypes_remote_internals.h)).  The shmem/semaphore-specific parts of the bindings are all in here.

* [`server_stub.c`](server_stub.c)
  Main function for the process that runs the C functions.  Set up the semaphores and shared memory and call the generated dispatch function.

* [`Makefile`](Makefile)

#### Generated files:

* `ex_remote_stubs.c`
  The generated dispatch function.  Wait on the argument semaphore, read the arguments, write the return value, post to the return value semaphore, repeat.

* `ex_generated.ml`
  The usual generated ML stubs, plus a call to the module initializer that sets up the shared memory and semaphores and forks the process.

* `ex_stubs.c`
  The usual generated C stubs, plus a module initializer function that sets up the shared memory and semaphores and forks the process.  Note that the generated code is independent of the communication mechanism, which is specified via various macros.

* `ex_shared_definitions.h`
  A generated enum definition with an entry for each bound function, and a generated struct definition with the arguments and return value for each bound function.
